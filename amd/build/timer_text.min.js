/**
 * Implementaton of the quizaccess_delayed timer JScript.
 * Based on quizaccess_activateattempt https://github.com/IITBombayWeb/moodle-quizaccess_delayed/tree/v1.0.3
 *
 * @package   quizaccess_delayed
 * @author    Juan Pablo de Castro
 * @copyright 2020 University of Valladolid, Spain
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define(["jquery"],(function(t){var e,i,n;return{get_string:function(t,i,n=null){return e[t]},set_strings:function(t){e=t},init:function(e=".continuebutton",a,r,s,d,u,o){if(t(".quizattempt #delayednotification").length>0)return!1;this.set_strings(o);var p=t("<form/>",{method:"post",action:a}).append(t("<input>",{type:"hidden",name:"cmid",value:r}),t("<input>",{type:"hidden",name:"sesskey",value:s}),t("<input>",{type:"submit",class:"btn btn-secondary",id:"startAttemptButton",value:d})),h=t('<div id="delayednotification" />').append(t("<p>",{id:"activatedelayedtimer"}));t(e).prepend(p,t("</br>")),t(e).prepend(h),t("[id=startAttemptButton]").prop("disabled",!0),i=(new Date).getTime()+u,n=setInterval(this.update_time.bind(this),1e3)},update_time:function(){var e=(new Date).getTime(),a=i-e,r=this.get_nice_duration(a/1e3,!0,!1,2);document.getElementById("activatedelayedtimer").innerHTML=this.get_string("quizwillstartinabout")+" "+r+" "+this.get_string("pleasewait"),a<0&&(t("#activatedelayedtimer").hide(),t("#startAttemptButton").show().prop("disabled",!1),clearInterval(n))},get_nice_duration:function(t,e=!0,i=!1,n=2){var a,r=[],s=!1;e&&(t-=2592e3*(a=Math.floor(t/2592e3)));var d=Math.floor(t/86400);t-=3600*d*24;var u=Math.floor(t/3600);t-=3600*u;var o=Math.floor(t/60),p=Math.round(t-60*o);return e&&a>0&&(r.push(a+this.get_string("month"+(a>1?"s":""))),u=0,o=0,p=0,i&&(s=!0)),d>0&&!1===s&&(r.push(" "+d+" "+this.get_string("day"+(d>1?"s":""))),n<2&&(o=0,p=0),i&&(s=!0)),u>0&&!1===s&&(r.push(" "+u+" "+this.get_string("hour"+(u>1?"s":""))),n<2&&(p=!1),i&&(s=!0)),o>0&&!1===s&&(r.push(" "+o+" "+this.get_string("minute"+(o>1?"s":""))),i&&(s=!0)),p>0&&!1===s&&r.push(" "+p+" s."),0===r.length&&r.push("-"),r.join("")}}}));